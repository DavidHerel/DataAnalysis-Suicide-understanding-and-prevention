---
title: "Suicide Notebook"
author: "David Herel"
date: "14.12.2020"
output:
  html_document:
    toc: true
    df_print: paged
    theme: readable
    highlight: tango
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
 
 
## Introduction

In this notebook I want to make a closer look on Suicide dataset and analyze it.

## Part I - Exploratory analysis of the suicide dataset
Load the dataset, visualize the main relationships and trends, 
preprocess the data, carry out dimensionality reduction and clustering. The main goal is to see whether there are
regularities in suicide rates across countries, continents, periods of times, etc.

### Analyze variables
So what about to start with analyzing dataset?
At **first**, we look on interesting variables and their behavior.

Let's start with most interesting one: 

#### Generation

#![Generation](ok_boomer.jpg)

```{r message = FALSE, warning = FALSE} 
#load data in to "data"
load(file="suicide.RData")

barplot(table(data$generation),col = rainbow(20))
```

We can see that generation **G.I.** and **Z** are not so big as others. My explanation is that we can view all generations as **Gauss distribution**, where **G.I.** is at the start of distribution and **generation Z** is at the end of distribution. Both generation dont have so many people in their group, because either they are too old or too young

#### Sex

```{r message = FALSE, warning = FALSE}
barplot(table(data$sex), col=c("pink", "blue"))
```

We can see we **same number** of males in females in dataset.

#### Age

```{r message = FALSE, warning = FALSE}
barplot(table(data$age), col="blue")
```

This is really **weird** for me. I would not divide data in these categories. I would make one category **for each age**. But I guess they chosed these categories because that makes data **equally distributed**.

#### Continent

```{r message = FALSE, warning = FALSE}
barplot(table(data$continent), col="blue")
```

I wanted to have a look on **countries** at first. But there were too many of them and it was **difficult** to read.

So when we switch to continents. We can see most data comes from **Europe and America**. 

So it is possible that the models and prediction will be more accurate for **them** and not so good for **other continents** like Africa or Oceania.

### Analyze correlations
Now we analyzed key variables and it is time to move on some **'high-level'** charts like interesting corelations.

#### Suicide ratio
What about overall **suicide rate**? Is it increasing, decreasing or stagnating?
```{r message = FALSE, warning = FALSE}
#libraries
library(magrittr) 
library(dplyr) 
library(ggplot2)


data_plot_suicide = data %>% # using suicide_data
  group_by(year) %>% # group all the data from the same year
  summarize(
            suicides_100k = (sum(suicides_no) / sum(population)) * 100000)

ggplot(data = data_plot_suicide, 
                      aes(x = year, y = suicides_100k)) +
  # points to each peak
  geom_point(col = 'blue') +
  
  # line of points
  geom_line(col = 'blue') +
  
  #change labels
  ylab('Suicides global per 100k') +
  xlab('Year')
  

```

We can see that overall trend is that suicide rate is **decreasing overtime**. 
And this greatly shows how statistics **can be wrong**, because our world is too complex to be predict by these models! (For now)

If we see this **model**. Everyone would predict that in couple of years the suicide rate will be even lower. But **COVID-19** hit. And we can see that suicides are massively increasing [^1] [^2]. 

To have a **correct** prediction we would have to develop model which can predict, when war **strikes or pandemic strikes** etc. And that is impossible in **near future**, in my opinion. 


[^1]: Gunnell D, Appleby L, Arensman E, et al., COVID-19 Suicide Prevention Research Collaboration. Suicide risk and prevention during the COVID-19 pandemic. Lancet Psychiatry2020;7:468-71. doi:10.1016/S2215-0366(20)30171-1 pmid:32330430
[^2]: Reger MA, Stanley IH, Joiner TE. Suicide mortality and coronavirus disease 2019: a perfect storm?JAMA Psychiatry2020. [Epub ahead of print.] doi:10.1001/jamapsychiatry.2020.1060 pmid:32275300

#### Man vs female
This statistics should be pretty **accurate** because there is equal number man and woman in dataset.

```{r message = FALSE, warning = FALSE}
library("pdp")

#same as in previous for global age
suicide_data_sex = data %>%
  group_by(year, sex) %>%
  summarize(suicide_100k = (sum(suicides_no) / sum(population)) * 100000)
  
  
ggplot(data = suicide_data_sex, 
       aes(x = year, y = suicide_100k, col = factor(sex))) + 
  facet_grid(sex ~ ., scales = "free_y") + 
  
  geom_line() + 
  geom_point() +
  
  #change labels
  xlab('Year') +
  ylab('Suicides global per 100k')+
  
  #change legend -> from factor(sex) to sex
  labs(color = 'Sex')



```

We see that **males** have a lot more suicides than **females**. There is not a single year, when females 'wins'. We could maybe use classical barplot for overall result, but I was more interested in **timeline** and how or if it changed.

#### Continents
There we will not get accurate results because, as I showed few sections before, we have far far more data from Europe/America than from other continents. So there can be huge **innaccuracy**.

```{r message = FALSE, warning = FALSE}

#same as in previous for global age
suicide_data_continent = data %>%
  group_by(year, continent) %>%
  summarize(suicide_100k = (sum(suicides_no) / sum(population)) * 100000)
  
  
ggplot(data = suicide_data_continent, 
       aes(x = year, y = suicide_100k, col = factor(continent))) + 
  facet_grid(continent ~ ., scales = "free_y") + 

  geom_line() + 
  geom_point() +
  
  #change labels
  xlab('Year') +
  ylab('Suicides global per 100k')+
  
  #change legend -> from factor(sex) to sex
  labs(color = 'Continent')

```

**Europe** has the most of suicides per 100k, but we see that this trend is **decreasing** over time. However in **America** it does do opposite - **increases**. **Asia oscilates** and is in middle - between America and Europe.
Oceania and Africa is not worth commenting, because we dont have enough data, in my opinion.

#### Age
In plot few sections before we saw that this variable is **equal among all categories** so the results will be accurate too.

```{r message = FALSE, warning = FALSE}
#same as in previous for global age
suicide_data_age = data %>%
  group_by(year, age) %>%
  summarize(suicide_100k = (sum(suicides_no) / sum(population)) * 100000)
  
ggplot(data = suicide_data_age, 
       aes(x = year, y = suicide_100k, col = factor(age))) + 
  facet_grid(age ~ ., scales = "free_y") + 
  
  geom_line() + 
  geom_point() +
  
  #change labels
  xlab('Year') +
  ylab('Suicides global per 100k')+
  
  #change legend -> from factor(age) to age
  labs(color = 'Age')


```

We can see that almost in all age categories the trend is decreasing over time. Also it is obvious, that most of suicides are commited by older people. We can really say: **The older you are, the higher chance of commiting suicide you have.**

## Part 2
In this part we will have a look on:
The outcome of the previous step should be a set of
candidate hypotheses about suicide patterns. In this task you are supposed to formally test them. An example hypothesis could be: Hnull: the overall
suicide rate across continents does not change, Ha: there is at least a pair of
continents whose overall suicide rates differ. You are supposed to propose and
test at least 3 hypotheses.

## Part 3

## Discussion
#![Thanks for the attention :) ](finished.PNG)
